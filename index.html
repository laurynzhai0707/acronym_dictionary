<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Acronym Dictionary</title>
<style>
 /* Page background */
      body{
        margin:0;
        font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
        background-image:url("HondaJet.jpg");        /* adjust if in a folder */
        background-repeat:no-repeat;
        background-position:center center;
        background-attachment:fixed;
        background-size:cover;
        min-height:100vh;
        overflow: hidden;
      }
      
      /* Centered card with translucent white */
      .page-wrap{ width:100%; display:flex; justify-content:center; margin-top:50px; }
      .card{ max-width:1000px; width:100%; text-align:center; }
      .page-wrap .card{
        background:rgba(255,255,255,0.85);
        padding:25px;
        border-radius:12px;
        box-shadow:0 2px 8px rgba(0,0,0,.15);
      }


    /* Guide text */
    .guide {
      font-size: 14px;
      margin-bottom: 20px;
      color: #444;
      text-align: left;
    }

    /* Search bar row */
    #searchBarWrapper {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
      justify-content: flex-start;
      overflow: auto;
    }
    #searchBarWrapper input {
      width: 320px;                /* fixed medium width */
      padding: 12px 14px;
      border: 1px solid #d0d7de;
      border-radius: 8px;
      outline: none;
      font-size: 14px;
    }
    #searchBarWrapper input:focus {
      border-color: #0969da;
      box-shadow: 0 0 0 3px rgba(9,105,218,.15);
    }
    #searchBarWrapper button {
      padding: 10px 14px;
      border: 1px solid #d0d7de;
      border-radius: 10px;
      background: #f6f8fa;
      cursor: pointer;
    }
    #searchBarWrapper button:hover {
      background: #eef2f7;
    }

    /* Upload form */
    #uploadForm { display: none; margin-top: 20px; }
    .form-inner {
      background: #f9fbfd;
      padding: 15px;
      border-radius: 10px;
      border: 1px solid #e5e9f0;
      text-align: left;
    }
    .form-title { margin: 0 0 10px 0; font-weight: 600; }
    .form-grid { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 10px; }
    .form-grid .field { display: flex; flex-direction: column; gap: 6px; }
    .form-grid textarea {
      padding: 10px 12px;
      border: 1px solid #d0d7de;
      border-radius: 10px;
      height: 44px;
      min-height: 44px;
      outline: none;
      resize: none;   /* all fixed, no drag */
      font-family: inherit;
      font-size: 14px;
      line-height: 1.4;
    }
    .form-actions button {
      padding: 10px 14px;
      border-radius: 10px;
      border: 1px solid #d0d7de;
      background: #0969da;
      color: #fff;
      cursor: pointer;
    }
    .form-actions button:hover { filter: brightness(0.95); }

    /* Table */
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    thead { display: none; }
    tbody { display: none; }
    th, td {
      border: 1px solid #e5e9f0;
      padding: 10px;
      text-align: left;
      vertical-align: top;
    }
    thead tr { background: #f4f6f9; }
    th:nth-child(1), td:nth-child(1) { width: 140px; }
    th:nth-child(2), td:nth-child(2) { width: 220px; }
    th:nth-child(4), td:nth-child(4) { width: 140px; text-align: center; }

    /* No results + actions */
    #noResultsMessage { display: none; margin-top: 10px; font-style: italic; color: #888; }
    #actionsRow { margin-top: 14px; display: flex; gap: 10px; justify-content: flex-end; }
    #actionsRow button { padding: 10px 14px; border-radius: 10px; border: 1px solid #d0d7de; background: #f6f8fa; cursor: pointer; }
    #actionsRow button.primary { background: #16a34a; color: #fff; border-color: #12833c; }
    #actionsRow button.primary:hover { filter: brightness(0.95); }

    /* Vote buttons */
    .vote {
      cursor: pointer;
      margin-right: 16px;
      user-select: none;
    }
    
    .vote.down.active {
      color: gray;  
      opacity: .45;              /* dim it */
      filter: grayscale(100%);   /* üëé becomes gray when selected */
    }
</style>
</head>
<body>

<div class="page-wrap">
    <div class="card">
      <h1 style="margin:0 0 20px; text-align:center;">HACI Acronym Dictionary</h1>

    <!-- User Guide -->
    <p class="guide">
      üîç <strong>How to Use:</strong><br>
      ‚Ä¢ Use the search fields below to find existing acronyms by typing either the abbreviation or the full name.<br>
      ‚Ä¢ When entering a new acronym, the form will pre-fill with your search to avoid retyping.<br>
      ‚Ä¢ Please ensure your submission is new and complete before adding.
    </p>

    <!-- SEARCH BAR AND UPLOAD FORM WRAPPER -->
    <div style="width:100%; display:flex; justify-content:center;">
      <div style="width:1000px;">

        <!-- Search UI (Full width alignment) -->
        <div id="searchBarWrapper">
          <input id="acronymSearchBox" placeholder="Search by Acronym (e.g., HACI)" />
          <input id="nameSearchBox" placeholder="Search by Name (e.g., Honda Aircraft Company)" />
          <button type="button" id="addBtn">‚ûï Add Acronym</button>
        </div>

        <!-- Upload Form -->
        <div id="uploadForm">
          <div class="form-inner">
            <p class="form-title">Fill out information about the new acronym below</p>
        <div class="form-grid">
          <div class="field" style="width:160px;">
            <label for="newAcronym">Acronym (required)</label>
            <textarea id="newAcronym" rows="1" placeholder="e.g., HACI"></textarea>
          </div>
          <div class="field" style="flex:1; min-width:260px;">
            <label for="newName">Name (required)</label>
            <textarea id="newName" rows="1" placeholder="e.g., Honda Aircraft Company"></textarea>
          </div>
          <div class="field" style="flex:1; min-width:340px;">
            <label for="newExplanation">Explanation (optional)</label>
            <textarea id="newExplanation" placeholder="Description, context, or usage notes..."></textarea>
          </div>
        </div>
            <div class="form-actions">
              <button type="button" id="submitBtn">Submit</button>
            </div>
          </div>
        </div>

      </div>
    </div>

    <!-- Acronym Table -->
    <table id="acronymTable">
      <thead id="tableHead">
        <tr>
          <th>Acronym</th>
          <th>Name</th>
          <th>Explanation</th>
          <th>Feedback</th>
        </tr>
      </thead>
      <tbody id="tableBody"></tbody>
    </table>

    <!-- No Results Message -->
    <div id="noResultsMessage">No results found.</div>
  </div>
</div>

<!-- SheetJS (XLSX) library -->
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>


<script>
  /* =========================
     CONFIG
  ========================= */
  const GH_RAW_XLSX_URL = 'acronyms.xlsx'; // adjust if file is in a folder
  
  /* =========================
     STATE
  ========================= */
  let rows = [];   // { Id, Title, Name, Explanation, ThumbsUp, ThumbsDown }
  let nextId = 1;  // fallback Id if sheet lacks one
  
  /* =========================
     UTILITIES
  ========================= */
  function voteKey(id){ return 'vote_' + id; }
  function getVote(id){ return localStorage.getItem(voteKey(id)); }
  function setVote(id, field){ localStorage.setItem(voteKey(id), field); }
  
  function normalizeRow(r, idx){
    return {
      Id: r.Id ?? idx + 1,
      Title: (r.Title || '').toString(),
      Name: (r.Name || '').toString(),
      Explanation: (r.Explanation || '').toString(),
      ThumbsUp: Number.isFinite(+r.ThumbsUp) ? +r.ThumbsUp : 0,
      ThumbsDown: Number.isFinite(+r.ThumbsDown) ? +r.ThumbsDown : 0
    };
  }
  
  /* =========================
     RENDER
  ========================= */
     function renderTable(filterAcr = '', filterName = ''){
       const tb = document.getElementById('tableBody');
       const th = document.getElementById('tableHead');
       const noRes = document.getElementById('noResultsMessage');
     
       tb.innerHTML = '';
     
       const A = filterAcr.trim().toUpperCase();
       const N = filterName.trim().toUpperCase();
     
       const filtered = rows.filter(r =>
         r.Title.toUpperCase().includes(A) && r.Name.toUpperCase().includes(N)
       );
     
       filtered.forEach(r => {
         const userVote = getVote(r.Id); // 'ThumbsUp' | 'ThumbsDown' | null
         const upCount   = r.ThumbsUp   + (userVote === 'ThumbsUp'   ? 1 : 0);
         const downCount = r.ThumbsDown + (userVote === 'ThumbsDown' ? 1 : 0);
     
         const tr = document.createElement('tr');
         tr.innerHTML = `
           <td>${r.Title}</td>
           <td>${r.Name}</td>
           <td>${r.Explanation}</td>
           <td style="text-align:center;">
             <span class="vote up ${userVote==='ThumbsUp' ? 'active' : ''}" data-id="${r.Id}" data-field="ThumbsUp">
               üëç <span class="count">${upCount}</span>
             </span>
             <span class="vote down ${userVote==='ThumbsDown' ? 'active' : ''}" data-id="${r.Id}" data-field="ThumbsDown">
               üëé <span class="count" style="display:none;">${downCount}</span>
             </span>
           </td>
         `;
         tb.appendChild(tr);
       });
     
       const hasInput = A.length > 0 || N.length > 0;
       const anyMatch = filtered.length > 0;
     
       document.getElementById('tableBody').style.display = hasInput && anyMatch ? 'table-row-group' : 'none';
       document.getElementById('tableHead').style.display = hasInput && anyMatch ? 'table-header-group' : 'none';
       noRes.style.display = hasInput && !anyMatch ? 'block' : 'none';
     
       const uploadForm = document.getElementById('uploadForm');
       if (hasInput && !anyMatch){
         uploadForm.style.display = 'block';
         if (A) document.getElementById('newAcronym').value = A;
         if (N) document.getElementById('newName').value = filterName;
       } else {
         uploadForm.style.display = 'none';
         document.getElementById('newAcronym').value = '';
         document.getElementById('newName').value = '';
         document.getElementById('newExplanation').value = '';
       }
     }

  /* =========================
     EVENTS
  ========================= */
  function onSearch(){
    const a = document.getElementById('acronymSearchBox').value;
    const n = document.getElementById('nameSearchBox').value;
    renderTable(a, n);
  }
  
  function toggleUploadForm(){
    const f = document.getElementById('uploadForm');
    const a = document.getElementById('acronymSearchBox').value.trim();
    const n = document.getElementById('nameSearchBox').value.trim();
    if (f.style.display === 'none'){
      if (a) document.getElementById('newAcronym').value = a.toUpperCase();
      if (n) document.getElementById('newName').value = n;
      f.style.display = 'block';
    } else {
      f.style.display = 'none';
    }
  }
  
  function submitAcronym(){
    const ac = document.getElementById('newAcronym').value.trim().toUpperCase();
    const nm = document.getElementById('newName').value.trim().toUpperCase();
    const ex = document.getElementById('newExplanation').value.trim();
    if (!ac || !nm){ alert('Acronym and Name are required.'); return; }
  
    const duplicate = rows.some(r => 
      r.Title.toUpperCase() === ac && r.Name.toUpperCase() === nm
    );
    if (duplicate && !confirm('‚ö†Ô∏è This acronym with the same name already exists. Do you want to add another entry?')) return;
  
    const newRow = { Id: ++nextId, Title: ac, Name: nm, Explanation: ex, ThumbsUp: 0, ThumbsDown: 0 };
    rows.push(newRow);
  
    // Refresh using current filters
    renderTable(document.getElementById('acronymSearchBox').value,
                document.getElementById('nameSearchBox').value);
  
    alert('‚úÖ Acronym added successfully.');
  }
  
  /* One-time vote; persists in localStorage; no undo */
    function handleVote(e){
      const target = e.target.closest('.vote');
      if (!target) return;
    
      const id    = Number(target.dataset.id);
      const field = target.dataset.field;     // 'ThumbsUp' | 'ThumbsDown'
      const prev  = getVote(id);              // previous vote or null
    
      const cell   = target.parentElement;
      const upEl   = cell.querySelector('.vote.up');
      const downEl = cell.querySelector('.vote.down');
    
      // helper: adjust the number inside a vote's .count (works even if hidden)
      const adjust = (el, delta) => {
        if (!el) return;
        const span = el.querySelector('.count');
        if (!span) return;
        const n = Number(span.textContent) || 0;
        span.textContent = String(n + delta);
      };
    
      if (prev === field) {
        // UNSELECT current vote
        localStorage.removeItem(voteKey(id));
        target.classList.remove('active');
        if (field === 'ThumbsUp')   adjust(upEl, -1);
        if (field === 'ThumbsDown') adjust(downEl, -1);
      } else {
        // SWITCH or NEW vote
        if (prev === 'ThumbsUp')   { upEl.classList.remove('active');   adjust(upEl, -1); }
        if (prev === 'ThumbsDown') { downEl.classList.remove('active'); adjust(downEl, -1); }
    
        localStorage.setItem(voteKey(id), field);
    
        if (field === 'ThumbsUp') {
          upEl.classList.add('active');
          adjust(upEl, +1);
        } else {
          downEl.classList.add('active');   // make üëé gray
          adjust(downEl, +1);               // update hidden count
        }
      }
    }

  /* =========================
     XLSX I/O
  ========================= */
  async function loadXlsx(){
    try{
      const res = await fetch(GH_RAW_XLSX_URL, { cache:'no-store' });
      if (!res.ok) throw new Error('Failed to fetch Excel. Ensure "acronyms.xlsx" exists in the repo.');
      const ab = await res.arrayBuffer();
      const wb = XLSX.read(ab);
      const ws = wb.Sheets[wb.SheetNames[0] || 'Sheet1'];
      const json = XLSX.utils.sheet_to_json(ws, { defval:'' });
  
      rows = json.map((r, i) => normalizeRow(r, i));
      nextId = rows.reduce((m, r) => Math.max(m, Number(r.Id)||0), 0) || rows.length;
  
      renderTable('', '');
    } catch (err){
      console.error(err);
      alert('‚ùå ' + err.message);
    }
  }
  
  /* =========================
     BOOTSTRAP
  ========================= */
  document.addEventListener('DOMContentLoaded', () => {
    loadXlsx();
  
    document.getElementById('acronymSearchBox').addEventListener('input', onSearch);
    document.getElementById('acronymTable').addEventListener('click', handleVote);
    document.getElementById('nameSearchBox').addEventListener('input', onSearch);
    document.getElementById('addBtn').addEventListener('click', toggleUploadForm);
    document.getElementById('submitBtn').addEventListener('click', submitAcronym);
  
    // delegate votes
    document.getElementById('acronymTable').addEventListener('click', handleVote);
  });
</script>
</script>
</body>
</html>






























